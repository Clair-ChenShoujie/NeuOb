产生过拟合的根本原因是什么呢？
- 模型复杂性
- 数据集大小
# 1.解决过拟合问题的方法
## （1）更多数据
**数据增强**：在图像处理等领域，数据增强（如旋转、翻转、裁剪等）可以有效增加数据量。

**K折交叉验证**：原始训练数据被分成K个不重叠的子集。 然后执行K次模型训练和验证，每次在K−1个子集上进行训练， 并在剩余的一个子集（在该轮中没有用于训练的子集）上进行验证。 最后，通过对K次实验的结果取平均来估计训练和验证误差。
## （2）减少特征数量
更少feature（哪个是有效feature？

- **特征选择方法**：
    - **过滤法**（如方差筛选、相关系数等）
    - **包裹法**（如递归特征消除）
    - **嵌入法**（如基于正则化的特征选择）
- **降维技术**：
    - **主成分分析（PCA）**
    - **线性判别分析（LDA）**

减少特征数量，还可以去除冗余和噪声特征
## （3）正则化

- **正则化**定义：减少泛化误差而非训练误差的方法

- **什么是L1正则化，L2正则化？**
![[Pasted image 20250726145843.png]]
- [ ] L0正则化：直接限制非零参数的数量，实现确切的特征选择。（非凸优化，不可行）

- [ ] L1正则化：通过对参数绝对值的惩罚，间接促使部分参数变为零，实现稀疏化。
损失=原始损失+λ(∣w1∣+∣w2∣)
惩罚项大，绝对值就小，更容易坐标轴的点和二次函数等高线相交
- [ ] L2正则化：通过对参数平方的惩罚，使权重接近于零，防止权重过大。

- **讲解L1、L2正则化的原理：**
- [ ] https://blog.csdn.net/zhaomengszu/article/details/81537197?fromshare=blogdetail&sharetype=blogdetail&sharerId=81537197&sharerefer=PC&sharesource=Annnclaire&sharefrom=from_link
- [ ] https://blog.csdn.net/zouxy09/article/details/24971995

- **实现L1、L2、Dropout**
- [ ] https://blog.nowcoder.net/n/ca2b651499704568ba5a54d99cdd982b?from=nowcoder_improve


![[Pasted image 20241116191814.png]]
两种正则化示意图![[Pasted image 20241116191802.png]]

## （4）提前停止

当神经网络功能过于强大时，很容易连训练样本中的错误样本也学习了，从而导致只能具有很低训练误差，而不能拥有较低的泛化误差，也就是我们所说的过拟合。最常见的方法之一是提前终止学习，如图所示：  
![](https://cleverbobo.github.io/2020/08/30/bp/11.png)
## （5）Dropout
在合适的迭代次数终止算法从而达到最优容量（泛化误差最低），但是最佳迭代次数并不好找，往往需要多次测试才有可能找到，因此更常用的方法是“Dropout”防止过拟合

**（一）什么是dropout**

**在每个训练批次中，通过忽略一半的特征检测器（让一半的隐层节点值为0），**
or
**我们在[[11前向传播和反向传播|前向传播]]的时候，让某个神经元的激活值以一定的概率p停止工作，这样可以使模型泛化性更强，因为它不会太依赖某些局部的特征**
![[Pasted image 20241115160457.png|400]]
**（二）Dropout具体工作流程**

假设我们要训练这样一个神经网络，如图所示。  
![|239](https://cleverbobo.github.io/2020/08/30/bp/13.png)  
输入是x，输出是y，正常的流程是：我们首先把x通过网络前向传播，然后把误差反向传播以决定如何更新参数让网络进行学习。使用Dropout之后，过程变成如下：

（1）首先随机（临时）删掉网络中一半的隐藏神经元，输入输出神经元保持不变（图中虚线为部分临时被删除的神经元）  
![|206](https://cleverbobo.github.io/2020/08/30/bp/14.png)  
（2） 然后把输入x通过修改后的网络前向传播，然后把得到的损失结果通过修改的网络反向传播。一小批训练样本执行完这个过程后，在没有被删除的神经元上按照随机梯度下降法更新对应的参数（w，b）。

（3）然后继续重复这一过程：

- 恢复被删掉的神经元（此时被删除的神经元保持原样，而没有被删除的神经元已经有所更新）
- 从隐藏层神经元中随机选择一个一半大小（这个量可以自己选）的子集临时删除掉（备份被删除神经元的参数）。
- 对一小批训练样本，先[[11前向传播和反向传播|前向传播]]然后[[11前向传播和反向传播|反向传播]]损失并根据随机梯度下降法更新参数（w，b） （没有被删除的那一部分参数得到更新，删除的神经元参数保持被删除前的结果）。

**（三）为什么说Dropout可以解决过拟合**

**（1）取平均的作用**： 先回到标准的模型，即没有dropout，我们用相同的训练数据去训练5个不同的神经网络，一般会得到5个不同的结果，此时我们可以采用 “5个结果取均值”或者“多数取胜的投票策略”去决定最终结果。例如3个网络判断结果为数字9,那么很有可能真正的结果就是数字9，其它两个网络给出了错误结果。这种“综合起来取平均”的策略通常可以有效防止过拟合问题。因为不同的网络可能产生不同的过拟合，取平均则有可能让一些“相反的”拟合互相抵消。dropout掉不同的隐藏神经元就类似在训练不同的网络，随机删掉一半隐藏神经元导致网络结构已经不同，整个dropout过程就相当于对很多个不同的神经网络取平均。而不同的网络产生不同的过拟合，一些互为“反向”的拟合相互抵消就可以达到整体上减少过拟合。

**（2）减少神经元之间复杂的共适应关系**： 因为dropout程序导致两个神经元不一定每次都在一个dropout网络中出现。这样权值的更新不再依赖于有固定关系的隐含节点的共同作用，阻止了某些特征仅仅在其它特定特征下才有效果的情况 。迫使网络去学习更加鲁棒的特征 ，这些特征在其它的神经元的随机子集中也存在。换句话说假如我们的神经网络是在做出某种预测，它不应该对一些特定的线索片段太过敏感，即使丢失特定的线索，它也应该可以从众多其它线索中学习一些共同的特征。从这个角度看dropout就有点像L1，L2正则，减少权重使得网络对丢失特定神经元连接的鲁棒性提高。

**（四）初始参数的选取**

在许多参考文献中都提到，对于神经网络而言。模型与优化的选取至关重要，当然这无可厚非，但是初始值的选取对于模型的训练也有一定程度的影响，不合适的初始值可能会耗费大量的训练时间，甚至有可能无法达到我们预期的目标，因此在这里简单介绍下初始值选取的一般规则：  
(1) **禁止将所有的权重均设置为同一个常数c，否则bp算法将会失效，所有的权重将不会更新！**  
(2) 一般令权重W的初始值服从0均值的高斯分布，该分布的方差应该选择合适的大小，如果过小会导致梯度消失，过大会导致权重无法收敛。  
(3) 方差选取的参考意见：第一种：$σ2=2/(n_{in}+n_{out})$，其中nin 与 nout分别为该层的上一层节点数量与下一层节点数量；第二种：$σ2=2/n_{in}$